<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Time-ordered data · Stripeline.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">Stripeline.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../basic/">Basic functions</a></li><li><a class="tocitem" href="../instrumentdb/">Instrument database</a></li><li class="is-active"><a class="tocitem" href>Time-ordered data</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#I/Q/U-TODs"><span>I/Q/U TODs</span></a></li></ul></li><li><a class="tocitem" href="../scanning/">Scanning strategy</a></li><li><a class="tocitem" href="../noise/">Noise generation</a></li><li><a class="tocitem" href="../prm/">Pointing Reconstruction Model</a></li><li><a class="tocitem" href="../acquisition/">Data acquisition</a></li><li><a class="tocitem" href="../mapmaking/">Map making</a></li><li><a class="tocitem" href="../simulation_tutorial/">Full-scale simulation tutorial</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Time-ordered data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Time-ordered data</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lspestrip/Stripeline.jl/blob/master/docs/src/tod.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Time-ordered-data-(TOD)"><a class="docs-heading-anchor" href="#Time-ordered-data-(TOD)">Time-ordered data (TOD)</a><a id="Time-ordered-data-(TOD)-1"></a><a class="docs-heading-anchor-permalink" href="#Time-ordered-data-(TOD)" title="Permalink"></a></h1><p>Stripeline contains functions that create the timeline of scientific data as produced by each polarimeter and distribute it across several parallel processes, potentially running through MPI.</p><p>A timeline of scientific data is generically called a <em>TOD</em>, and the polarimeters implemented in Strip produce a complex flow of data, as they output <em>eight</em> series:</p><ul><li>Four series are called <em><code>PWR</code> series</em>: <code>PWR_Q1</code>,   <code>PWR_Q2</code>, <code>PWR_U1</code>, and <code>PWR_U2</code>;</li><li>Four series are called <em><code>DEM</code> series</em>: <code>DEM_Q1</code>,   <code>DEM_Q2</code>, <code>DEM_U1</code>, and <code>DEM_U2</code>.</li></ul><p>Each of these series is sampled at 50 Hz and contains scientific data (in the preliminary unit tests done in 2017, the sampling frequency was 25 Hz; keep this in mind if you happen to replicate some returns of those ancient tests!); the raw instrument represents them as integer numbers, but Stripeline usually assumes they have already been calibrated to Kelvin and therefore uses floating-point numbers.</p><p>A TOD is represented by the structure <a href="#Stripeline.StripTod"><code>StripTod</code></a>, which contains the following fields:</p><ul><li><code>polarimeters</code>: a generic sequence of values, which represent each   polarimeter stored in the TOD. Very common choices for this field   are a range (for example, <code>1:49</code> represents all the Q-band   polarimeters) or a list of strings, e.g., <code>[&quot;I0&quot;, &quot;I3&quot;, &quot;V2&quot;]</code>.</li><li><code>time_range</code>: a range representing the time of each sample in the   TOD. Very common choices for this are floating-point ranges like   <code>0.0:(1 / 50):100.0</code> (100 s sampled at 50 Hz) and ranges of   astronomical times, created using the   <a href="https://juliaastro.github.io/AstroTime.jl/stable/">AstroTime</a>   package.</li><li><code>samples</code>: this is the matrix containing the actual scientific   samples. It has a shape of <span>$N \times 8 \times m$</span>, where <span>$N$</span> is   the number of samples along the time axis and must be equal to   <code>length(time_range)</code>, and <span>$m$</span> is the number of polarimeters,   which must be equal to <code>length(polarimeters)</code>. The middle   dimension is 8 because there are eight timelines produced by each   polarimeter (see above).</li></ul><p>Allocating the TOD is a matter of calling the function <a href="#Stripeline.allocate_tod"><code>allocate_tod</code></a>:</p><pre><code class="language-julia">using Stripeline

# One minute of data sampled at 50 Hz, 10 polarimeters
tod = allocate_tod(StripTod, Float32, 0.0:(1.0 / 50.0):60.0, 1:10)</code></pre><pre class="documenter-example-output">TOD(10 polarimeters, 3001 rows/polarimeter, time range from 0.0 to 60.0)</pre><p>In a MPI environment, you can pass the keywords <code>mpi_rank</code> and <code>mpi_size</code> to <a href="#Stripeline.allocate_tod"><code>allocate_tod</code></a> and the function will only allocate the subset of the overall time range that is assigned to the running MPI process.</p><p>Once a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable is allocated, accessing the samples in the TOD can be done through the field <code>samples</code>, which is a matrix:</p><pre><code class="language-julia">println(&quot;The shape of the TOD is &quot;, size(tod.samples))</code></pre><pre class="documenter-example-output">The shape of the TOD is (3001, 8, 10)</pre><p>Accessing the right column can be cumbersome, as there are eight of them (<code>PWR_Q1</code>, <code>PWR_Q2</code>, …), so Stripeline provides the constants <a href="#Stripeline.PWR_Q1_RANK"><code>PWR_Q1_RANK</code></a>, <a href="#Stripeline.PWR_Q2_RANK"><code>PWR_Q2_RANK</code></a>, … for this:</p><pre><code class="language-julia"># Print the minimum sample acquired by PWR_Q1 for polarimeter number #4
println(minimum(tod.samples[:, PWR_Q1_RANK, 4]))</code></pre><pre class="documenter-example-output">0.0</pre><p>The result is zero because <a href="#Stripeline.allocate_tod"><code>allocate_tod</code></a> sets all the samples to zero by default. An alternative approach is to use one of the functions <a href="#Stripeline.pwrq1"><code>pwrq1</code></a>, <a href="#Stripeline.pwrq2"><code>pwrq2</code></a>, <a href="#Stripeline.pwru1"><code>pwru1</code></a>, <a href="#Stripeline.pwru2"><code>pwru2</code></a>, <a href="#Stripeline.demq1"><code>demq1</code></a>, <a href="#Stripeline.demq2"><code>demq2</code></a>, <a href="#Stripeline.demu1"><code>demu1</code></a>, <a href="#Stripeline.demu2"><code>demu2</code></a>, which return a <em>view</em> of the original array and can thus be used both for reading and writing:</p><pre><code class="language-julia"># Set one element of PWR_Q1 for polarimeter number #4
pwrq1(tod, 4)[142] = 1.36
println(
    &quot;The maximum element of polarimeter #4 is now &quot;,
    maximum(pwrq1(tod, 4)),
)</code></pre><pre class="documenter-example-output">The maximum element of polarimeter #4 is now 1.36</pre><article class="docstring"><header><a class="docstring-binding" id="Stripeline.StripTod" href="#Stripeline.StripTod"><code>Stripeline.StripTod</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A matrix of time-ordered PWR/DEM data for a subset of polarimeters</p><p>The fields of this structure are the following:</p><ul><li><p><code>time_range</code>: a range representing the time of each sample in the TOD.</p></li><li><p><code>samples</code>: a N×8×m matrix, where N is the number of samples in the timeline, and m is the number of polarimeters. The middle dimension spans the three Stokes parameters <code>I</code>, <code>Q</code>, and <code>U</code> (in this order). The value <code>N</code> is equal to <code>length(time_range)</code></p></li><li><p><code>rng</code>: a pseudo-random number generator to be used for this TOD. It is guaranteed that the generator is uncorrelated with any other generator used for other <code>StripTod</code> objects created by the same call to <code>allocate_tod</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L59-L77">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.allocate_tod" href="#Stripeline.allocate_tod"><code>Stripeline.allocate_tod</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">allocate_tod(todtype, t, time_range, polarimeters; mpi_rank=0, mpi_size=1, zero_tod=true)</code></pre><p>Allocate memory for a time-ordered data matrix appropriate for the set of polarimeters in the variable <code>polarimeters</code> (an array or range, only its length is used and it is copied as-is in the returned <a href="#Stripeline.StripTod"><code>StripTod</code></a> value). The type of each sample is set to <code>t</code>. The variable <code>time_range</code> must be a range of floating-point values or epochs (as defined by the <a href="https://juliaastro.github.io/AstroTime.jl/stable/">AstroTime</a> package) which represent the full set of samples acquired during an observation.</p><p>The optional parameters <code>mpi_rank</code> and <code>mpi_size</code> can be used in MPI scripts to allocate only the subset of samples that must be processed by the current MPI process.</p><p>If <code>zero_tod</code> is true, each sample in the TOD is set to zero; otherwise, its value is undefined. Using <code>zero_tod = false</code> is slightly faster, but it should be used only if you are going to set by hand every sample in the TOD once <code>allocate_tod</code> returns.</p><p>Return a <a href="#Stripeline.StripTod"><code>StripTod</code></a> value.</p><p><strong>Example</strong></p><pre><code class="language-julia-repl">julia&gt; tod = allocate_tod(StripTod, Float32, 0.0:0.01:100.0, 1:5)
TOD(5 polarimeters, 10001 rows/polarimeter, time range from 0.0 to 100.0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L205-L236">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.PWR_Q1_RANK" href="#Stripeline.PWR_Q1_RANK"><code>Stripeline.PWR_Q1_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">PWR_Q1_RANK = 1</code></pre><p>The rank of <code>PWR_Q1</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.PWR_Q2_RANK" href="#Stripeline.PWR_Q2_RANK"><code>Stripeline.PWR_Q2_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">PWR_Q2_RANK = 2</code></pre><p>The rank of <code>PWR_Q2</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.PWR_U1_RANK" href="#Stripeline.PWR_U1_RANK"><code>Stripeline.PWR_U1_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">PWR_U1_RANK = 3</code></pre><p>The rank of <code>PWR_U1</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.PWR_U2_RANK" href="#Stripeline.PWR_U2_RANK"><code>Stripeline.PWR_U2_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">PWR_U2_RANK = 4</code></pre><p>The rank of <code>PWR_U2</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.DEM_Q1_RANK" href="#Stripeline.DEM_Q1_RANK"><code>Stripeline.DEM_Q1_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">DEM_Q1_RANK = 5</code></pre><p>The rank of <code>DEM_Q1</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.DEM_Q2_RANK" href="#Stripeline.DEM_Q2_RANK"><code>Stripeline.DEM_Q2_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">DEM_Q2_RANK = 6</code></pre><p>The rank of <code>DEM_Q2</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.DEM_U1_RANK" href="#Stripeline.DEM_U1_RANK"><code>Stripeline.DEM_U1_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">DEM_U1_RANK = 7</code></pre><p>The rank of <code>DEM_U1</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.DEM_U2_RANK" href="#Stripeline.DEM_U2_RANK"><code>Stripeline.DEM_U2_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">DEM_U2_RANK = 8</code></pre><p>The rank of <code>DEM_U2</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.pwrq1" href="#Stripeline.pwrq1"><code>Stripeline.pwrq1</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pwrq1(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>PWR_Q1</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, PWR_Q1_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.pwrq2" href="#Stripeline.pwrq2"><code>Stripeline.pwrq2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pwrq2(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>PWR_Q2</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, PWR_Q2_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.pwru1" href="#Stripeline.pwru1"><code>Stripeline.pwru1</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pwru1(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>PWR_U1</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, PWR_U1_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.pwru2" href="#Stripeline.pwru2"><code>Stripeline.pwru2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">pwru2(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>PWR_U2</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, PWR_U2_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.demq1" href="#Stripeline.demq1"><code>Stripeline.demq1</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">demq1(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>DEM_Q1</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, DEM_Q1_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.demq2" href="#Stripeline.demq2"><code>Stripeline.demq2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">demq2(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>DEM_Q2</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, DEM_Q2_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.demu1" href="#Stripeline.demu1"><code>Stripeline.demu1</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">demu1(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>DEM_U1</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, DEM_U1_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.demu2" href="#Stripeline.demu2"><code>Stripeline.demu2</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">demu2(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>DEM_U2</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, DEM_U2_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><h1 id="I/Q/U-TODs"><a class="docs-heading-anchor" href="#I/Q/U-TODs">I/Q/U TODs</a><a id="I/Q/U-TODs-1"></a><a class="docs-heading-anchor-permalink" href="#I/Q/U-TODs" title="Permalink"></a></h1><p>The scientific information kept in a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable is encoded in eight timelines (PWR<em>Q1<code>,</code>PWR</em>Q2<code>,</code>PWR<em>U1<code>,</code>PWR</em>U2<code>,</code>DEM<em>Q1<code>,</code>DEM</em>Q2<code>,</code>DEM<em>U1<code>,</code>DEM</em>U2`), but most of the information in these timelines is redundant and is essentially correlated/uncorrelated noise.</p><p>The eight timelines can be combined to provide a direct estimate of the four Stokes parameters <span>$I$</span>, <span>$Q$</span>, and <span>$U$</span> in the reference frame of the detector, using these formulae:</p><p class="math-container">\[\begin{aligned}
I &amp;= \frac{\text{PWRQ1} + \text{PWRQ2} + \text{PWRU1} + \text{PWRU2}}4,\\
Q &amp;= \frac{\text{PWRQ1} - \text{PWRQ2}}2,\\
U &amp;= \frac{\text{PWRU1} - \text{PWRU2}}2.
\end{aligned}\]</p><p>The three <span>$I$</span>/<span>$Q$</span>/<span>$U$</span> timelines can be stored in a <a href="#Stripeline.StokesTod"><code>StokesTod</code></a> variable, which behaves exactly like a <a href="#Stripeline.StripTod"><code>StripTod</code></a> but only contains three timeseries instead of eight. To allocate it, you can use <a href="#Stripeline.allocate_tod"><code>allocate_tod</code></a> again, passing a <a href="#Stripeline.StokesTod"><code>StokesTod</code></a> parameter:</p><pre><code class="language-julia">stokestod = allocate_tod(StokesTod, Float32, 0.0:(1.0 / 50.0):60.0, 1:10)</code></pre><pre class="documenter-example-output">StokesTOD(10 polarimeters, 3001 rows/polarimeter, time range from 0.0 to 60.0)</pre><p>Or you can compute it starting from a <a href="#Stripeline.StokesTod"><code>StokesTod</code></a> variable:</p><pre><code class="language-julia">stokestod = stokes(tod)</code></pre><pre class="documenter-example-output">StokesTOD(10 polarimeters, 3001 rows/polarimeter, time range from 0.0 to 60.0)</pre><p>The latter call works out-of-the-box in a MPI environment, of course. You can access the <span>$I$</span>/<span>$Q$</span>/<span>$U$</span> timelines either using the explicit indexes <a href="#Stripeline.STOKES_I_RANK"><code>STOKES_I_RANK</code></a>, <a href="#Stripeline.STOKES_Q_RANK"><code>STOKES_Q_RANK</code></a>, <a href="#Stripeline.STOKES_U_RANK"><code>STOKES_U_RANK</code></a>, or the three functions <a href="#Stripeline.stokesi"><code>stokesi</code></a>, <a href="#Stripeline.stokesq"><code>stokesq</code></a>, <a href="#Stripeline.stokesu"><code>stokesu</code></a>, similarly to what was described above for <a href="#Stripeline.StripTod"><code>StripTod</code></a>.</p><article class="docstring"><header><a class="docstring-binding" id="Stripeline.StokesTod" href="#Stripeline.StokesTod"><code>Stripeline.StokesTod</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A matrix of time-ordered PWR/DEM data for a subset of polarimeters</p><p>The fields of this structure are the following:</p><ul><li><p><code>time_range</code>: a range representing the time of each sample in the TOD.</p></li><li><p><code>samples</code>: a N×8×m matrix, where N is the number of samples in the timeline, and m is the number of polarimeters. The middle dimension spans the three Stokes parameters <code>I</code>, <code>Q</code>, and <code>U</code> (in this order). The value <code>N</code> is equal to <code>length(time_range)</code></p></li><li><p><code>rng</code>: a pseudo-random number generator to be used for this TOD. It is guaranteed that the generator is uncorrelated with any other generator used for other <code>StripTod</code> objects created by the same call to <code>allocate_tod</code>.</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L97-L115">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.stokes" href="#Stripeline.stokes"><code>Stripeline.stokes</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">stokes(tod::StripTod{T, S, R})</code></pre><p>Return a <a href="#Stripeline.StokesTod"><code>StokesTod</code></a> variable containing the estimated <span>$I$</span>/<span>$Q$</span>/<span>$U$</span> Stokes parameters associated with the parameter <code>tod</code>, which is a time-ordered data variable containing the eight outputs <code>PWR_Q1</code>, <code>PWR_Q2</code>, <code>PWR_U1</code>, <code>PWR_U2</code>, <code>DEM_Q1</code>, <code>DEM_Q2</code>, <code>DEM_U1</code>, <code>DEM_U2</code> of a set of Strip polarimeters.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L283-L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.STOKES_I_RANK" href="#Stripeline.STOKES_I_RANK"><code>Stripeline.STOKES_I_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">STOKES_I_RANK = 1</code></pre><p>The rank of <code>STOKES_I</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.STOKES_Q_RANK" href="#Stripeline.STOKES_Q_RANK"><code>Stripeline.STOKES_Q_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">STOKES_Q_RANK = 2</code></pre><p>The rank of <code>STOKES_Q</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.STOKES_U_RANK" href="#Stripeline.STOKES_U_RANK"><code>Stripeline.STOKES_U_RANK</code></a> — <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia">STOKES_U_RANK = 3</code></pre><p>The rank of <code>STOKES_U</code> in the <code>samples</code> field of a <a href="#Stripeline.StripTod"><code>StripTod</code></a> variable.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L161-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.stokesi" href="#Stripeline.stokesi"><code>Stripeline.stokesi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">stokesi(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>STOKES_I</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, STOKES_I_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.stokesq" href="#Stripeline.stokesq"><code>Stripeline.stokesq</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">stokesq(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>STOKES_Q</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, STOKES_Q_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Stripeline.stokesu" href="#Stripeline.stokesu"><code>Stripeline.stokesu</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">stokesu(tod::Stripeline.StripTod, pol::T) where T &lt;: Integer</code></pre><p>Return a view of the timeline for channel <code>STOKES_U</code> in the time-ordered data for the polarimeter indexed by <code>pol</code> in <code>tod</code>. It is a shortcut for</p><pre><code class="nohighlight">tod.samples[:, STOKES_U_RANK, pol]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lspestrip/Stripeline.jl/blob/ec6691a9201d7949e49aeab7a205c34d2c689496/src/tod.jl#L190-L199">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../instrumentdb/">« Instrument database</a><a class="docs-footer-nextpage" href="../scanning/">Scanning strategy »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Wednesday 25 January 2023 10:04">Wednesday 25 January 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
